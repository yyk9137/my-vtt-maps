<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>VTT Âú∞ÂõæÊü•ÁúãÂô®</title><script type="module">import{Fragment as e,computed as t,createApp as a,createCommentVNode as n,createElementBlock as l,createElementVNode as o,createTextVNode as i,createVNode as s,defineComponent as r,onMounted as u,onUnmounted as d,openBlock as c,ref as p,renderList as v,toDisplayString as f,vModelText as m,watch as h,withDirectives as g}from'https://testingcf.jsdelivr.net/npm/vue/+esm';import{gsap as b}from'https://testingcf.jsdelivr.net/npm/gsap/+esm';import{Application as k,Assets as y,Container as x,Graphics as w,Sprite as C,Text as D}from'https://testingcf.jsdelivr.net/npm/pixi.js/+esm';import{default as T}from'https://testingcf.jsdelivr.net/npm/lodash/+esm';import{z as M}from'https://testingcf.jsdelivr.net/npm/zod/+esm';var V={42:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}}},j={};const S={class:'map-controls'},E={key:0,class:'token-info'},U=r({__name:'MapCanvas',props:{mapData:{},tokens:{}},emits:['tokenMove','tokenSelect'],setup(e,{emit:t}){const a=e,i=t,s=p(),r=p(),v=p(!0),m=p(a.mapData.fogOfWar.enabled),g=p(!a.mapData.globalLight),T=p(!0),M=p(null);let V=null,j=null,U=null,A=null,O=null,L=null,I=null,N=null;const R=p({x:0,y:0,scale:1}),{isLineBlocked:Y,calculateFOVShadowCasting:B}=function(){function e(e,a,n,l,o){for(const i of o){if(0===i.sense)continue;if(i.door>0&&1===i.ds)continue;const[o,s,r,u]=i.c;if(t(e,a,n,l,o,s,r,u))return!0}return!1}function t(e,t,a,n,l,o,i,s){const r=(s-o)*(a-e)-(i-l)*(n-t);if(Math.abs(r)<1e-10)return!1;const u=((i-l)*(t-o)-(s-o)*(e-l))/r,d=((a-e)*(t-o)-(n-t)*(e-l))/r;return u>=0&&u<=1&&d>=0&&d<=1}function a(e,t,l,o,i,s,r,u,d,c,p,v,f){if(i<s)return;let m=i;for(let h=o;h<=l;h++){let o=!1;for(let g=-h;g<=0;g++){const b=-h,k=(g-.5)/(b+.5),y=(g+.5)/(b-.5);if(i<y)continue;if(s>k)break;const x=e+g*r+b*u,w=t+g*d+b*c;if(Math.abs(x-e)+Math.abs(w-t)<=l&&f.add(`${x},${w}`),o){if(n(x,w,p,v)){m=y;continue}o=!1,i=m}else n(x,w,p,v)&&h<l&&(o=!0,a(e,t,l,h+1,i,k,r,u,d,c,p,v,f),m=y)}if(o)break}}function n(e,t,a,n){const l=e*n+n/2,o=t*n+n/2;for(const e of a){if(0===e.sense)continue;if(e.door>0&&1===e.ds)continue;const[t,a,n,i]=e.c,s=Math.min(t,n),r=Math.max(t,n),u=Math.min(a,i),d=Math.max(a,i);if(l>=s&&l<=r&&o>=u&&o<=d)return!0}return!1}return{isLineBlocked:e,calculateVisibleArea:function(t,a,n){const l=[],o=t.x,i=t.y,s=t.vision*n;if(s<=0)return l;const r=2*Math.PI/360;for(let t=0;t<360;t++){const u=t*r,d=Math.cos(u),c=Math.sin(u);for(let t=0;t<=s;t+=n/2){const s=o+d*t,r=i+c*t;if(e(o,i,s,r,a))break;const u=Math.floor(s/n),p=Math.floor(r/n);l.some(e=>e.x===u&&e.y===p)||l.push({x:u,y:p})}}return l},calculateFOVShadowCasting:function(e,t,n,l,o){const i=new Set,s=Math.floor(e/o),r=Math.floor(t/o);i.add(`${s},${r}`);const u=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(const[e,t]of u)a(s,r,n,1,1,0,e,t,0,0,l,o,i);return i}}}();function X(){if(!A)return;if(A.clear(),!v.value)return;const{width:e,height:t,grid:n,gridColor:l,gridAlpha:o}=a.mapData;A.lineStyle(1,parseInt(l.replace('#','0x')),o);for(let a=0;a<=e;a+=n)A.moveTo(a,0),A.lineTo(a,t);for(let a=0;a<=t;a+=n)A.moveTo(0,a),A.lineTo(e,a);A.stroke()}function F(){if(L&&(L.removeChildren(),g.value))for(const e of a.mapData.lights){const t=new w,n=e.dim*a.mapData.grid,l=e.bright*a.mapData.grid,o=parseInt(e.tintColor.replace('#','0x'));n>0&&(t.circle(e.x,e.y,n),t.fill({color:o,alpha:.2*e.tintAlpha})),l>0&&(t.circle(e.x,e.y,l),t.fill({color:o,alpha:.5*e.tintAlpha})),t.circle(e.x,e.y,5),t.fill({color:16776960,alpha:.8}),L.addChild(t),b.to(t,{alpha:.7,duration:1+Math.random(),repeat:-1,yoyo:!0,ease:'power1.inOut'})}}function W(){if(!I)return;I.removeChildren();const e=a.tokens||a.mapData.tokens||[];for(const t of e){const e=new w,n=t.width*a.mapData.grid,l=t.x,o=t.y;e.circle(l,o,n/2),e.fill({color:65280,alpha:.6}),e.stroke({width:2,color:16777215});const s=new D({text:t.name,style:{fontSize:12,fill:16777215,stroke:{color:0,width:2}}});s.anchor.set(.5),s.x=l,s.y=o+n/2+10,e.addChild(s),e.eventMode='static',e.cursor='pointer';let r=!1,u=null;e.on('pointerdown',e=>{r=!0;const a=e.global;u={x:a.x-l,y:a.y-o},M.value=t,i('tokenSelect',t)}),e.on('pointerup',()=>{r=!1,u=null}),e.on('pointermove',a=>{if(r&&u){const n=a.global,s=n.x-u.x,r=n.y-u.y;e.x=s-l,e.y=r-o,i('tokenMove',t,s,r)}}),I.addChild(e)}}function J(){if(!N)return;if(N.clear(),!m.value)return;N.rect(0,0,a.mapData.width,a.mapData.height),N.fill({color:0,alpha:.8});const e=a.tokens||a.mapData.tokens||[];for(const t of e){if(t.vision<=0)continue;const e=B(t.x,t.y,t.vision,a.mapData.walls,a.mapData.grid);for(const t of e){const[e,n]=t.split(',').map(Number),l=e*a.mapData.grid,o=n*a.mapData.grid;N.rect(l,o,a.mapData.grid,a.mapData.grid),N.fill({color:0,alpha:-1})}}}function P(){R.value.scale*=1.2,b.to(V.stage.scale,{x:R.value.scale,y:R.value.scale,duration:.3})}function H(){R.value.scale*=.8,b.to(V.stage.scale,{x:R.value.scale,y:R.value.scale,duration:.3})}function G(){R.value={x:0,y:0,scale:1},b.to(V.stage,{x:0,y:0,duration:.5}),b.to(V.stage.scale,{x:1,y:1,duration:.5})}function q(){v.value=!v.value,X()}function K(){m.value=!m.value,J()}function Q(){g.value=!g.value,F()}function Z(){T.value=!T.value,U&&(U.visible=T.value)}return u(async()=>{if(!s.value||!r.value)return;V=new k,await V.init({canvas:r.value,width:s.value.clientWidth,height:s.value.clientHeight,backgroundColor:a.mapData.backgroundColor||'#000000',antialias:!0});const e=new x,t=new x,n=new x;L=new x,I=new x;const l=new x,o=new x;if(V.stage.addChild(e),V.stage.addChild(t),V.stage.addChild(n),V.stage.addChild(L),V.stage.addChild(I),V.stage.addChild(l),V.stage.addChild(o),a.mapData.img){const t=await y.load(a.mapData.img);j=new C(t),j.width=a.mapData.width,j.height=a.mapData.height,e.addChild(j)}if(a.mapData.foreground){const e=await y.load(a.mapData.foreground);U=new C(e),U.width=a.mapData.width,U.height=a.mapData.height,l.addChild(U),toastr.info('Â∑≤Âä†ËΩΩÂâçÊôØÂ±Ç (ÈÅÆÊå°Áâ©)')}A=new w,t.addChild(A),X(),O=new w,n.addChild(O),function(){if(!O)return;O.clear();for(const e of a.mapData.walls){const[t,a,n,l]=e.c;let o=16777215,i=.8,s=3;1===e.door?(o=9127187,s=1===e.ds?2:4):2===e.door&&(o=9662683,i=.5),0===e.sense&&(o=4286945,i=.4),O.lineStyle(s,o,i),O.moveTo(t,a),O.lineTo(n,l)}O.stroke()}(),F(),W(),N=new w,o.addChild(N),m.value&&J(),function(){if(!V)return;let e=!1,t={x:0,y:0};V.stage.eventMode='static',V.stage.on('pointerdown',a=>{a.target===V?.stage&&(e=!0,t={x:a.globalX,y:a.globalY})}),V.stage.on('pointerup',()=>{e=!1}),V.stage.on('pointermove',a=>{if(e){const e=a.globalX-t.x,n=a.globalY-t.y;V.stage.x+=e,V.stage.y+=n,t={x:a.globalX,y:a.globalY}}}),r.value?.addEventListener('wheel',e=>{e.preventDefault();const t=e.deltaY>0?.9:1.1,a=R.value.scale*t;a>=.1&&a<=5&&(R.value.scale=a,b.to(V.stage.scale,{x:a,y:a,duration:.2,ease:'power2.out'}))})}();const i=new ResizeObserver(()=>{V&&s.value&&V.renderer.resize(s.value.clientWidth,s.value.clientHeight)});i.observe(s.value),d(()=>{i.disconnect()})}),h(()=>a.tokens,()=>{W(),m.value&&J()},{deep:!0}),d(()=>{V?.destroy(!0)}),(e,t)=>(c(),l('div',{class:'map-canvas-container',ref_key:'containerRef',ref:s},[o('canvas',{ref_key:'canvasRef',ref:r},null,512),n(' ÊéßÂà∂Èù¢Êùø '),o('div',S,[o('button',{onClick:P,title:'ÊîæÂ§ß'},[...t[1]||(t[1]=[o('span',null,'üîç+',-1)])]),o('button',{onClick:H,title:'Áº©Â∞è'},[...t[2]||(t[2]=[o('span',null,'üîç-',-1)])]),o('button',{onClick:G,title:'ÈáçÁΩÆËßÜÂõæ'},[...t[3]||(t[3]=[o('span',null,'üè†',-1)])]),o('button',{onClick:q,title:'ÊòæÁ§∫/ÈöêËóèÁΩëÊ†º'},[o('span',null,f(v.value?'‚äû':'‚äü'),1)]),o('button',{onClick:K,title:'Êàò‰∫âËø∑Èõæ'},[o('span',null,f(m.value?'üå´Ô∏è':'‚òÄÔ∏è'),1)]),o('button',{onClick:Q,title:'ÂÖâÁÖßÁ≥ªÁªü'},[o('span',null,f(g.value?'üí°':'üî¶'),1)]),a.mapData.foreground?(c(),l('button',{key:0,onClick:Z,title:'ÊòæÁ§∫/ÈöêËóèÂâçÊôØÂ±Ç'},[o('span',null,f(T.value?'üè†':'üèöÔ∏è'),1)])):n('v-if',!0)]),n(' Token ‰ø°ÊÅØÈù¢Êùø '),M.value?(c(),l('div',E,[o('h3',null,f(M.value.name),1),o('p',null,'‰ΩçÁΩÆ: ('+f(Math.floor(M.value.x))+', '+f(Math.floor(M.value.y))+')',1),o('p',null,'ËßÜÈáé: '+f(M.value.vision)+' Ê†º',1),o('button',{onClick:t[0]||(t[0]=e=>M.value=null)},'ÂÖ≥Èó≠')])):n('v-if',!0)],512))}});var A=function e(t){var a=j[t];if(void 0!==a)return a.exports;var n=j[t]={exports:{}};return V[t](n,n.exports,e),n.exports}(42);const O=(0,A.A)(U,[['__scopeId','data-v-6d3eac8c']]),L=M.object({x:M.number(),y:M.number(),dim:M.number().default(0),bright:M.number().default(0),tintColor:M.string().default('#ffffff'),tintAlpha:M.number().min(0).max(1).default(.5),animation:M.object({type:M.string().optional(),speed:M.number().optional(),intensity:M.number().optional()}).optional()}),I=M.object({c:M.tuple([M.number(),M.number(),M.number(),M.number()]),move:M.union([M.literal(0),M.literal(1)]).default(1),sense:M.union([M.literal(0),M.literal(1)]).default(1),sound:M.union([M.literal(0),M.literal(1)]).default(1),door:M.union([M.literal(0),M.literal(1),M.literal(2)]).default(0),ds:M.union([M.literal(0),M.literal(1)]).optional()}),N=M.object({id:M.string(),name:M.string().default('Êú™ÂëΩÂêç'),x:M.number(),y:M.number(),width:M.number().default(1),height:M.number().default(1),img:M.string().optional(),vision:M.number().default(0),dimVision:M.number().default(0),rotation:M.number().default(0),hidden:M.boolean().default(!1),elevation:M.number().default(0)}),R=M.object({name:M.string().default('Êú™ÂëΩÂêçÂú∞Âõæ'),width:M.number().positive(),height:M.number().positive(),grid:M.number().positive().default(100),shiftX:M.number().default(0),shiftY:M.number().default(0),gridDistance:M.number().positive().default(5),gridUnits:M.string().default('ft'),padding:M.number().default(0),gridColor:M.string().default('#000000'),gridAlpha:M.number().min(0).max(1).default(.2),globalLight:M.boolean().default(!0),darkness:M.number().min(0).max(1).default(0),backgroundColor:M.string().default('#000000'),img:M.string().nullable().optional(),foreground:M.string().nullable().optional(),lights:M.array(L).default([]),walls:M.array(I).default([]),tokens:M.array(N).default([]),fogOfWar:M.object({enabled:M.boolean().default(!1),explored:M.array(M.array(M.boolean())).optional()}).default({enabled:!1})}),Y=M.object({mapId:M.string(),tokens:M.array(N),fogExplored:M.array(M.array(M.boolean())).optional(),viewport:M.object({x:M.number().default(0),y:M.number().default(0),scale:M.number().default(1)}).default({})});const B={class:'vtt-viewer'},X={key:0,class:'loading'},F={key:1,class:'error'},W={class:'toolbar'},J={class:'toolbar-actions'},P={class:'map-wrapper'},H={key:0,class:'side-panel token-manager'},G={class:'panel-header'},q={class:'panel-content'},K={class:'token-header'},Q=['onClick'],Z={class:'token-details'},ee=['onUpdate:modelValue'],te=['onUpdate:modelValue'],ae=['onUpdate:modelValue'],ne=['onUpdate:modelValue'],le=['onUpdate:modelValue'],oe={key:1,class:'side-panel map-info'},ie={class:'panel-header'},se={class:'panel-content'},re={class:'info-item'},ue={class:'info-item'},de={class:'info-item'},ce={class:'info-item'},pe={class:'info-item'},ve={class:'info-item'},fe={class:'info-item'},me=r({__name:'App',setup(a){const r=p(!0),d=p(null),b=p(null),k=p(!1),y=p(!1),x=p(null),w=t(()=>x.value?x.value.state.value.tokens:b.value?.tokens||[]);async function C(){r.value=!0,d.value=null;try{const e=getVariables({type:'script',script_id:getScriptId()});if(!e.vtt_map_url&&!e.vtt_map_data)throw new Error('Êú™ÈÖçÁΩÆÂú∞ÂõæÊï∞ÊçÆ„ÄÇËØ∑Âú®ËÑöÊú¨ÂèòÈáè‰∏≠ËÆæÁΩÆ vtt_map_url Êàñ vtt_map_data');let t;if(e.vtt_map_url){const a=await fetch(e.vtt_map_url);t=await a.json()}else t=e.vtt_map_data;const a=R.parse(t);b.value=a,x.value=function(e){const t=t=>{try{const a=`vtt_map_${e}`,n=T.cloneDeep(t);replaceVariables({[a]:n},{type:'chat'})}catch(e){console.error('‰øùÂ≠òÂú∞ÂõæÁä∂ÊÄÅÂ§±Ë¥•:',e)}},a=p((()=>{try{const t=getVariables({type:'chat'}),a=`vtt_map_${e}`;if(t[a])return Y.parse(t[a])}catch(e){console.warn('Âä†ËΩΩÂú∞ÂõæÁä∂ÊÄÅÂ§±Ë¥•:',e)}return{mapId:e,tokens:[],viewport:{x:0,y:0,scale:1}}})()),n=T.debounce(e=>{t(e)},1e3);return h(a,e=>{n(e)},{deep:!0}),{state:a,updateTokenPosition:(e,t,n)=>{const l=a.value.tokens.find(t=>t.id===e);l&&(l.x=t,l.y=n)},addToken:e=>{a.value.tokens.find(t=>t.id===e.id)||a.value.tokens.push(e)},removeToken:e=>{const t=a.value.tokens.findIndex(t=>t.id===e);-1!==t&&a.value.tokens.splice(t,1)},updateViewport:(e,t,n)=>{a.value.viewport={x:e,y:t,scale:n}},markExplored:(e,t)=>{a.value.fogExplored||(a.value.fogExplored=[]),a.value.fogExplored[t]||(a.value.fogExplored[t]=[]),a.value.fogExplored[t][e]=!0},isExplored:(e,t)=>a.value.fogExplored?.[t]?.[e]??!1,saveState:()=>t(a.value)}}(a.name),0===x.value.state.value.tokens.length&&a.tokens.length>0&&a.tokens.forEach(e=>{x.value?.addToken(e)}),toastr.success(`Âú∞Âõæ "${a.name}" Âä†ËΩΩÊàêÂäü`)}catch(e){d.value=e instanceof Error?e.message:String(e),toastr.error('Âú∞ÂõæÂä†ËΩΩÂ§±Ë¥•: '+d.value)}finally{r.value=!1}}function D(e,t,a){x.value?.updateTokenPosition(e.id,t,a)}function M(e){console.log('ÈÄâ‰∏≠ Token:',e)}function V(){if(!x.value||!b.value)return;const e=N.parse({id:`token_${Date.now()}`,name:`Token ${w.value.length+1}`,x:b.value.width/2,y:b.value.height/2,width:1,height:1,vision:12});x.value.addToken(e),toastr.success(`Ê∑ªÂä†‰∫ÜÊñ∞ÁöÑ Token: ${e.name}`)}function j(){if(!x.value)return;const e=x.value.state.value,t=JSON.stringify(e,null,2);navigator.clipboard.writeText(t).then(()=>{toastr.success('Áä∂ÊÄÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')}).catch(()=>{const e=new Blob([t],{type:'application/json'}),a=URL.createObjectURL(e),n=document.createElement('a');n.href=a,n.download=`${b.value?.name}_state.json`,n.click(),URL.revokeObjectURL(a)})}function S(){const e=prompt('ËØ∑Á≤òË¥¥Âú∞ÂõæÁä∂ÊÄÅ JSON:');if(e)try{const t=JSON.parse(e);replaceVariables({[`vtt_map_${b.value?.name}`]:t},{type:'chat'}),toastr.success('Áä∂ÊÄÅÂØºÂÖ•ÊàêÂäü,Ê≠£Âú®ÈáçÊñ∞Âä†ËΩΩ...'),setTimeout(()=>location.reload(),1e3)}catch(e){toastr.error('ÂØºÂÖ•Â§±Ë¥•: '+(e instanceof Error?e.message:String(e)))}}return u(()=>{C()}),(t,a)=>(c(),l('div',B,[r.value?(c(),l('div',X,[...a[4]||(a[4]=[o('div',{class:'spinner'},null,-1),o('p',null,'Âä†ËΩΩÂú∞Âõæ‰∏≠...',-1)])])):d.value?(c(),l('div',F,[a[5]||(a[5]=o('h2',null,'‚ùå Âä†ËΩΩÂ§±Ë¥•',-1)),o('pre',null,f(d.value),1),o('button',{onClick:C},'ÈáçËØï')])):b.value?(c(),l(e,{key:2},[n(' È°∂ÈÉ®Â∑•ÂÖ∑Ê†è '),o('div',W,[o('h2',null,f(b.value.name),1),o('div',J,[o('button',{onClick:a[0]||(a[0]=e=>k.value=!k.value)},'üé≠ Token ÁÆ°ÁêÜ'),o('button',{onClick:a[1]||(a[1]=e=>y.value=!y.value)},'‚ÑπÔ∏è Âú∞Âõæ‰ø°ÊÅØ'),o('button',{onClick:j},'üíæ ÂØºÂá∫Áä∂ÊÄÅ'),o('button',{onClick:S},'üìÅ ÂØºÂÖ•Áä∂ÊÄÅ')])]),n(' Âú∞ÂõæÁîªÂ∏É '),o('div',P,[s(O,{'map-data':b.value,tokens:w.value,onTokenMove:D,onTokenSelect:M},null,8,['map-data','tokens'])]),n(' Token ÁÆ°ÁêÜÈù¢Êùø '),k.value?(c(),l('div',H,[o('div',G,[a[6]||(a[6]=o('h3',null,'Token ÁÆ°ÁêÜ',-1)),o('button',{onClick:a[2]||(a[2]=e=>k.value=!1)},'‚úñ')]),o('div',q,[o('button',{onClick:V,class:'add-token-btn'},'‚ûï Ê∑ªÂä† Token'),(c(!0),l(e,null,v(w.value,e=>(c(),l('div',{key:e.id,class:'token-item'},[o('div',K,[o('strong',null,f(e.name),1),o('button',{onClick:t=>{return a=e.id,void(x.value&&confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™ Token Âêó?')&&(x.value.removeToken(a),toastr.success('Token Â∑≤Âà†Èô§')));var a},class:'delete-btn'},'üóëÔ∏è',8,Q)]),o('div',Z,[o('label',null,[a[7]||(a[7]=i(' ÂêçÁß∞: ',-1)),g(o('input',{'onUpdate:modelValue':t=>e.name=t,type:'text'},null,8,ee),[[m,e.name]])]),o('label',null,[a[8]||(a[8]=i(' X: ',-1)),g(o('input',{'onUpdate:modelValue':t=>e.x=t,type:'number',step:'10'},null,8,te),[[m,e.x,void 0,{number:!0}]])]),o('label',null,[a[9]||(a[9]=i(' Y: ',-1)),g(o('input',{'onUpdate:modelValue':t=>e.y=t,type:'number',step:'10'},null,8,ae),[[m,e.y,void 0,{number:!0}]])]),o('label',null,[a[10]||(a[10]=i(' ËßÜÈáéËåÉÂõ¥: ',-1)),g(o('input',{'onUpdate:modelValue':t=>e.vision=t,type:'number',min:'0',max:'100'},null,8,ne),[[m,e.vision,void 0,{number:!0}]])]),o('label',null,[a[11]||(a[11]=i(' Â∞∫ÂØ∏: ',-1)),g(o('input',{'onUpdate:modelValue':t=>e.width=t,type:'number',min:'1',max:'10'},null,8,le),[[m,e.width,void 0,{number:!0}]])])])]))),128))])])):n('v-if',!0),n(' Âú∞Âõæ‰ø°ÊÅØÈù¢Êùø '),y.value?(c(),l('div',oe,[o('div',ie,[a[12]||(a[12]=o('h3',null,'Âú∞Âõæ‰ø°ÊÅØ',-1)),o('button',{onClick:a[3]||(a[3]=e=>y.value=!1)},'‚úñ')]),o('div',se,[o('div',re,[a[13]||(a[13]=o('label',null,'Âú∞ÂõæÂêçÁß∞:',-1)),o('span',null,f(b.value.name),1)]),o('div',ue,[a[14]||(a[14]=o('label',null,'Â∞∫ÂØ∏:',-1)),o('span',null,f(b.value.width)+' √ó '+f(b.value.height)+' px',1)]),o('div',de,[a[15]||(a[15]=o('label',null,'ÁΩëÊ†º:',-1)),o('span',null,f(b.value.grid)+' px ('+f(b.value.gridDistance)+' '+f(b.value.gridUnits)+')',1)]),o('div',ce,[a[16]||(a[16]=o('label',null,'ÂÖâÊ∫êÊï∞Èáè:',-1)),o('span',null,f(b.value.lights.length),1)]),o('div',pe,[a[17]||(a[17]=o('label',null,'Â¢ôÂ£ÅÊï∞Èáè:',-1)),o('span',null,f(b.value.walls.length),1)]),o('div',ve,[a[18]||(a[18]=o('label',null,'ÂÖ®Â±ÄÂÖâÁÖß:',-1)),o('span',null,f(b.value.globalLight?'ÊòØ':'Âê¶'),1)]),o('div',fe,[a[19]||(a[19]=o('label',null,'ÈªëÊöóÁ≠âÁ∫ß:',-1)),o('span',null,f((100*b.value.darkness).toFixed(0))+'%',1)])])])):n('v-if',!0)],64)):n('v-if',!0)]))}}),he=(0,A.A)(me,[['__scopeId','data-v-712ceb6a']]);$(()=>{a(he).mount('#app'),toastr.success('VTT Âú∞ÂõæÊü•ÁúãÂô®Â∑≤Âä†ËΩΩ')}),$(window).on('pagehide',()=>{toastr.info('VTT Âú∞ÂõæÊü•ÁúãÂô®Â∑≤Âç∏ËΩΩ')});</script><style>.map-canvas-container[data-v-6d3eac8c]{position:relative;width:100%;height:100%;overflow:hidden;background:#1a1a1a}canvas[data-v-6d3eac8c]{display:block;width:100%;height:100%}.map-controls[data-v-6d3eac8c]{position:absolute;top:10px;right:10px;display:flex;flex-direction:column;gap:5px;z-index:10}.map-controls button[data-v-6d3eac8c]{width:40px;height:40px;border:none;background:rgba(0,0,0,0.7);color:white;border-radius:5px;cursor:pointer;font-size:18px;transition:background 0.2s}.map-controls button[data-v-6d3eac8c]:hover{background:rgba(0,0,0,0.9)}.token-info[data-v-6d3eac8c]{position:absolute;bottom:10px;left:10px;background:rgba(0,0,0,0.8);color:white;padding:15px;border-radius:8px;min-width:200px;z-index:10}.token-info h3[data-v-6d3eac8c]{margin:0 0 10px 0;font-size:16px}.token-info p[data-v-6d3eac8c]{margin:5px 0;font-size:14px}.token-info button[data-v-6d3eac8c]{margin-top:10px;padding:5px 10px;background:#4caf50;border:none;color:white;border-radius:4px;cursor:pointer}.token-info button[data-v-6d3eac8c]:hover{background:#45a049}

.vtt-viewer[data-v-712ceb6a]{width:100%;height:100vh;display:flex;flex-direction:column;background:#1a1a1a;color:white;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}.loading[data-v-712ceb6a],.error[data-v-712ceb6a]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:20px}.spinner[data-v-712ceb6a]{width:50px;height:50px;border:4px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin-712ceb6a 1s linear infinite}@keyframes spin-712ceb6a{to{transform:rotate(360deg)}}.error pre[data-v-712ceb6a]{background:rgba(255,0,0,0.2);padding:15px;border-radius:5px;max-width:600px}.error button[data-v-712ceb6a]{padding:10px 20px;background:#4caf50;border:none;color:white;border-radius:5px;cursor:pointer}.toolbar[data-v-712ceb6a]{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:rgba(0,0,0,0.8);border-bottom:2px solid #333}.toolbar h2[data-v-712ceb6a]{margin:0;font-size:20px}.toolbar-actions[data-v-712ceb6a]{display:flex;gap:10px}.toolbar-actions button[data-v-712ceb6a]{padding:8px 15px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);color:white;border-radius:5px;cursor:pointer;transition:background 0.2s}.toolbar-actions button[data-v-712ceb6a]:hover{background:rgba(255,255,255,0.2)}.map-wrapper[data-v-712ceb6a]{flex:1;position:relative}.side-panel[data-v-712ceb6a]{position:absolute;top:60px;right:10px;width:300px;max-height:calc(100vh - 80px);background:rgba(0,0,0,0.9);border:1px solid #333;border-radius:8px;overflow:hidden;display:flex;flex-direction:column;z-index:100}.panel-header[data-v-712ceb6a]{display:flex;justify-content:space-between;align-items:center;padding:15px;background:rgba(255,255,255,0.1);border-bottom:1px solid #333}.panel-header h3[data-v-712ceb6a]{margin:0;font-size:16px}.panel-header button[data-v-712ceb6a]{background:none;border:none;color:white;font-size:18px;cursor:pointer}.panel-content[data-v-712ceb6a]{flex:1;overflow-y:auto;padding:15px}.add-token-btn[data-v-712ceb6a]{width:100%;padding:10px;background:#4caf50;border:none;color:white;border-radius:5px;cursor:pointer;margin-bottom:15px}.token-item[data-v-712ceb6a]{background:rgba(255,255,255,0.05);padding:10px;border-radius:5px;margin-bottom:10px}.token-header[data-v-712ceb6a]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.delete-btn[data-v-712ceb6a]{background:rgba(255,0,0,0.3);border:none;color:white;padding:4px 8px;border-radius:3px;cursor:pointer}.token-details[data-v-712ceb6a]{display:flex;flex-direction:column;gap:8px}.token-details label[data-v-712ceb6a]{display:flex;justify-content:space-between;align-items:center;font-size:14px}.token-details input[data-v-712ceb6a]{width:120px;padding:4px 8px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);color:white;border-radius:3px}.info-item[data-v-712ceb6a]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.1)}.info-item label[data-v-712ceb6a]{font-weight:bold}

</style></head><body><div id="app"></div></body></html>