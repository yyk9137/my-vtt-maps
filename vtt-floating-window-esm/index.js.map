{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/src/VTT地图悬浮窗-ESM版/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\r\n * VTT 地图查看器 - 悬浮窗脚本 (ES Module 版本)\r\n * 专为酒馆助手的 import 语句设计\r\n */\r\n\r\n// VTT 地图 URL\r\nconst VTT_MAP_URL = 'https://yyk9137.github.io/my-vtt-maps/vtt-map-viewer/index.html';\r\n\r\n/**\r\n * 初始化函数 - 导出给酒馆助手调用\r\n */\r\nexport function init() {\r\n  // 等待 DOM 加载完成\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', loadVTTMap);\r\n  } else {\r\n    loadVTTMap();\r\n  }\r\n}\r\n\r\n/**\r\n * 加载 VTT 地图悬浮窗\r\n */\r\nfunction loadVTTMap() {\r\n  // 检查 jQuery 是否可用\r\n  if (typeof $ === 'undefined') {\r\n    console.error('❌ jQuery 未加载,无法初始化 VTT 地图悬浮窗');\r\n    return;\r\n  }\r\n\r\n  // 使用 jQuery 的方式初始化\r\n  $(() => {\r\n    toastr.success('🗺️ VTT 地图悬浮窗已加载');\r\n\r\n    // 创建浮动按钮\r\n    createFloatingButton();\r\n\r\n    // 注册快捷键\r\n    registerKeyboardShortcuts();\r\n  });\r\n\r\n  // 卸载时清理\r\n  $(window).on('pagehide', () => {\r\n    $('#vtt-map-button').remove();\r\n    $('#vtt-floating-window').remove();\r\n    toastr.info('🗺️ VTT 地图悬浮窗已卸载');\r\n  });\r\n}\r\n\r\n/**\r\n * 创建浮动按钮\r\n */\r\nfunction createFloatingButton(): void {\r\n  // 避免重复创建\r\n  if ($('#vtt-map-button').length > 0) {\r\n    return;\r\n  }\r\n\r\n  const button = $('<button>')\r\n    .attr('id', 'vtt-map-button')\r\n    .attr('title', '打开 VTT 地图 (Ctrl+M)')\r\n    .css({\r\n      position: 'fixed',\r\n      bottom: '20px',\r\n      right: '20px',\r\n      zIndex: '9999',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      gap: '8px',\r\n      padding: '12px 20px',\r\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n      color: 'white',\r\n      border: 'none',\r\n      borderRadius: '50px',\r\n      boxShadow: '0 4px 15px rgba(102, 126, 234, 0.4)',\r\n      fontSize: '16px',\r\n      fontWeight: '600',\r\n      cursor: 'pointer',\r\n      transition: 'all 0.3s ease',\r\n    })\r\n    .html(`\r\n      <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        <path d=\"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z\"/>\r\n      </svg>\r\n      <span>地图</span>\r\n    `)\r\n    .on('click', () => {\r\n      toggleFloatingWindow();\r\n    })\r\n    .on('mouseenter', function () {\r\n      $(this).css({\r\n        transform: 'translateY(-2px)',\r\n        boxShadow: '0 6px 20px rgba(102, 126, 234, 0.6)',\r\n      });\r\n    })\r\n    .on('mouseleave', function () {\r\n      $(this).css({\r\n        transform: 'translateY(0)',\r\n        boxShadow: '0 4px 15px rgba(102, 126, 234, 0.4)',\r\n      });\r\n    });\r\n\r\n  $('body').append(button);\r\n}\r\n\r\n/**\r\n * 注册键盘快捷键\r\n */\r\nfunction registerKeyboardShortcuts(): void {\r\n  $(document).on('keydown', e => {\r\n    // Ctrl + M: 打开/关闭地图\r\n    if (e.ctrlKey && e.key === 'm') {\r\n      e.preventDefault();\r\n      toggleFloatingWindow();\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 切换悬浮窗显示/隐藏\r\n */\r\nfunction toggleFloatingWindow(): void {\r\n  const existingWindow = $('#vtt-floating-window');\r\n\r\n  if (existingWindow.length > 0) {\r\n    // 已存在,切换显示\r\n    if (existingWindow.is(':visible')) {\r\n      existingWindow.hide();\r\n    } else {\r\n      existingWindow.show();\r\n    }\r\n  } else {\r\n    // 不存在,创建新窗口\r\n    createFloatingWindow();\r\n  }\r\n}\r\n\r\n/**\r\n * 创建悬浮窗\r\n */\r\nfunction createFloatingWindow(): void {\r\n  // 创建窗口容器\r\n  const window = $('<div>')\r\n    .attr('id', 'vtt-floating-window')\r\n    .css({\r\n      position: 'fixed',\r\n      top: '50%',\r\n      left: '50%',\r\n      transform: 'translate(-50%, -50%)',\r\n      width: '80vw',\r\n      height: '80vh',\r\n      maxWidth: '1400px',\r\n      minWidth: '400px',\r\n      minHeight: '300px',\r\n      background: '#1a1a1a',\r\n      border: '2px solid #667eea',\r\n      borderRadius: '12px',\r\n      boxShadow: '0 10px 40px rgba(0, 0, 0, 0.5)',\r\n      zIndex: '10000',\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      overflow: 'hidden',\r\n    });\r\n\r\n  // 创建标题栏\r\n  const titleBar = createTitleBar(window);\r\n  window.append(titleBar);\r\n\r\n  // 创建内容区域\r\n  const content = createContent();\r\n  window.append(content);\r\n\r\n  // 添加到页面\r\n  $('body').append(window);\r\n\r\n  // 启用拖动\r\n  enableDragging(window, titleBar);\r\n\r\n  // 启用调整大小\r\n  enableResizing(window);\r\n\r\n  // 注册窗口快捷键\r\n  registerWindowShortcuts(window);\r\n\r\n  // 显示动画\r\n  window.hide().fadeIn(300);\r\n}\r\n\r\n/**\r\n * 创建标题栏\r\n */\r\nfunction createTitleBar(window: JQuery): JQuery {\r\n  const titleBar = $('<div>').css({\r\n    padding: '12px 20px',\r\n    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    cursor: 'move',\r\n    userSelect: 'none',\r\n  });\r\n\r\n  // 标题\r\n  const title = $('<div>')\r\n    .css({\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      gap: '10px',\r\n      color: 'white',\r\n      fontSize: '18px',\r\n      fontWeight: '600',\r\n    })\r\n    .html(`\r\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n        <path d=\"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z\"/>\r\n      </svg>\r\n      <span>VTT 地图查看器</span>\r\n    `);\r\n\r\n  // 控制按钮\r\n  const controls = $('<div>').css({ display: 'flex', gap: '8px' });\r\n\r\n  // 最小化按钮\r\n  const minimizeBtn = createControlButton('➖', '最小化', '#ff9800', '#fb8c00', () => {\r\n    const content = window.find('.vtt-content');\r\n    if (content.is(':visible')) {\r\n      content.hide();\r\n      window.css('height', 'auto');\r\n      minimizeBtn.html('⬜');\r\n    } else {\r\n      content.show();\r\n      window.css('height', '80vh');\r\n      minimizeBtn.html('➖');\r\n    }\r\n  });\r\n\r\n  // 全屏按钮\r\n  const fullscreenBtn = createControlButton('⛶', '全屏', '#2196f3', '#1e88e5', () => {\r\n    if (window.css('width') === '100vw') {\r\n      // 退出全屏\r\n      window.css({\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        width: '80vw',\r\n        height: '80vh',\r\n        borderRadius: '12px',\r\n      });\r\n      fullscreenBtn.html('⛶');\r\n    } else {\r\n      // 进入全屏\r\n      window.css({\r\n        top: '0',\r\n        left: '0',\r\n        transform: 'none',\r\n        width: '100vw',\r\n        height: '100vh',\r\n        borderRadius: '0',\r\n      });\r\n      fullscreenBtn.html('🗗');\r\n    }\r\n  });\r\n\r\n  // 关闭按钮\r\n  const closeBtn = createControlButton('❌', '关闭 (Esc)', '#f44336', '#e53935', () => {\r\n    window.hide();\r\n  });\r\n\r\n  controls.append(minimizeBtn, fullscreenBtn, closeBtn);\r\n  titleBar.append(title, controls);\r\n\r\n  return titleBar;\r\n}\r\n\r\n/**\r\n * 创建控制按钮\r\n */\r\nfunction createControlButton(\r\n  text: string,\r\n  title: string,\r\n  bgColor: string,\r\n  hoverColor: string,\r\n  onClick: () => void,\r\n): JQuery {\r\n  return $('<button>')\r\n    .attr('title', title)\r\n    .css({\r\n      padding: '6px 12px',\r\n      border: 'none',\r\n      borderRadius: '5px',\r\n      color: 'white',\r\n      fontSize: '14px',\r\n      fontWeight: '600',\r\n      cursor: 'pointer',\r\n      background: bgColor,\r\n      transition: 'all 0.2s ease',\r\n    })\r\n    .html(text)\r\n    .on('click', onClick)\r\n    .on('mouseenter', function () {\r\n      $(this).css({ background: hoverColor, transform: 'scale(1.05)' });\r\n    })\r\n    .on('mouseleave', function () {\r\n      $(this).css({ background: bgColor, transform: 'scale(1)' });\r\n    });\r\n}\r\n\r\n/**\r\n * 创建内容区域\r\n */\r\nfunction createContent(): JQuery {\r\n  const content = $('<div>')\r\n    .addClass('vtt-content')\r\n    .css({\r\n      flex: '1',\r\n      position: 'relative',\r\n      overflow: 'hidden',\r\n      background: '#0a0a0a',\r\n    });\r\n\r\n  // 加载提示\r\n  const loading = $('<div>').css({\r\n    position: 'absolute',\r\n    top: '0',\r\n    left: '0',\r\n    width: '100%',\r\n    height: '100%',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    gap: '20px',\r\n    background: '#0a0a0a',\r\n    color: 'white',\r\n    zIndex: '1',\r\n  }).html(`\r\n    <div style=\"width: 50px; height: 50px; border: 4px solid rgba(102, 126, 234, 0.3); border-top-color: #667eea; border-radius: 50%; animation: spin 1s linear infinite;\"></div>\r\n    <p style=\"margin: 0; font-size: 18px; color: #667eea;\">正在加载 VTT 地图...</p>\r\n  `);\r\n\r\n  // 创建 iframe\r\n  const iframe = $('<iframe>')\r\n    .css({\r\n      width: '100%',\r\n      height: '100%',\r\n      border: 'none',\r\n      background: 'white',\r\n    })\r\n    .attr('src', VTT_MAP_URL)\r\n    .attr('allow', 'fullscreen')\r\n    .on('load', () => {\r\n      loading.fadeOut();\r\n      toastr.success('🗺️ 地图加载完成');\r\n    })\r\n    .on('error', () => {\r\n      loading.html(`\r\n        <div style=\"font-size: 50px;\">⚠️</div>\r\n        <p>地图加载失败</p>\r\n        <small style=\"font-size: 14px; color: #999;\">请检查 URL 是否正确</small>\r\n      `);\r\n      toastr.error('❌ 地图加载失败');\r\n    });\r\n\r\n  content.append(loading, iframe);\r\n  return content;\r\n}\r\n\r\n/**\r\n * 启用拖动\r\n */\r\nfunction enableDragging(window: JQuery, titleBar: JQuery): void {\r\n  let isDragging = false;\r\n  let startX = 0;\r\n  let startY = 0;\r\n\r\n  titleBar.on('mousedown', e => {\r\n    // 忽略按钮点击\r\n    if ($(e.target).closest('button').length > 0) {\r\n      return;\r\n    }\r\n\r\n    isDragging = true;\r\n    const offset = window.offset()!;\r\n    startX = e.pageX - offset.left;\r\n    startY = e.pageY - offset.top;\r\n    titleBar.css('cursor', 'grabbing');\r\n    $('body').css('userSelect', 'none');\r\n  });\r\n\r\n  $(document).on('mousemove', e => {\r\n    if (isDragging && window.css('width') !== '100vw') {\r\n      const x = e.pageX - startX;\r\n      const y = e.pageY - startY;\r\n      const maxX = $(window).width()! - window.outerWidth()!;\r\n      const maxY = $(window).height()! - window.outerHeight()!;\r\n\r\n      window.css({\r\n        left: Math.max(0, Math.min(x, maxX)) + 'px',\r\n        top: Math.max(0, Math.min(y, maxY)) + 'px',\r\n        transform: 'none',\r\n      });\r\n    }\r\n  });\r\n\r\n  $(document).on('mouseup', () => {\r\n    if (isDragging) {\r\n      isDragging = false;\r\n      titleBar.css('cursor', 'move');\r\n      $('body').css('userSelect', '');\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 启用调整大小\r\n */\r\nfunction enableResizing(window: JQuery): void {\r\n  // 创建调整手柄\r\n  const directions = ['n', 'e', 's', 'w', 'ne', 'se', 'sw', 'nw'];\r\n  directions.forEach(dir => {\r\n    const handle = $('<div>').css({\r\n      position: 'absolute',\r\n      zIndex: '10',\r\n      ...getHandlePosition(dir),\r\n      cursor: `${dir}-resize`,\r\n    });\r\n    window.append(handle);\r\n  });\r\n\r\n  let isResizing = false;\r\n  let currentDirection = '';\r\n  let startX = 0;\r\n  let startY = 0;\r\n  let startWidth = 0;\r\n  let startHeight = 0;\r\n  let startLeft = 0;\r\n  let startTop = 0;\r\n\r\n  window.find('div').each(function () {\r\n    const handle = $(this);\r\n    const position = handle.css('position');\r\n    if (position === 'absolute' && handle.css('cursor').includes('resize')) {\r\n      handle.on('mousedown', e => {\r\n        if (window.css('width') === '100vw') return; // 全屏时禁用\r\n\r\n        isResizing = true;\r\n        currentDirection = handle.css('cursor').replace('-resize', '');\r\n        startX = e.pageX;\r\n        startY = e.pageY;\r\n        startWidth = window.width()!;\r\n        startHeight = window.height()!;\r\n        startLeft = window.offset()!.left;\r\n        startTop = window.offset()!.top;\r\n        $('body').css('userSelect', 'none');\r\n        e.preventDefault();\r\n      });\r\n    }\r\n  });\r\n\r\n  $(document).on('mousemove', e => {\r\n    if (isResizing) {\r\n      const deltaX = e.pageX - startX;\r\n      const deltaY = e.pageY - startY;\r\n      let newWidth = startWidth;\r\n      let newHeight = startHeight;\r\n      let newLeft = startLeft;\r\n      let newTop = startTop;\r\n\r\n      if (currentDirection.includes('e')) newWidth = startWidth + deltaX;\r\n      if (currentDirection.includes('w')) {\r\n        newWidth = startWidth - deltaX;\r\n        newLeft = startLeft + deltaX;\r\n      }\r\n      if (currentDirection.includes('s')) newHeight = startHeight + deltaY;\r\n      if (currentDirection.includes('n')) {\r\n        newHeight = startHeight - deltaY;\r\n        newTop = startTop + deltaY;\r\n      }\r\n\r\n      newWidth = Math.max(400, newWidth);\r\n      newHeight = Math.max(300, newHeight);\r\n\r\n      window.css({\r\n        width: newWidth + 'px',\r\n        height: newHeight + 'px',\r\n        left: newLeft + 'px',\r\n        top: newTop + 'px',\r\n      });\r\n    }\r\n  });\r\n\r\n  $(document).on('mouseup', () => {\r\n    if (isResizing) {\r\n      isResizing = false;\r\n      $('body').css('userSelect', '');\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 获取调整手柄的位置\r\n */\r\nfunction getHandlePosition(direction: string): Record<string, string> {\r\n  const positions: Record<string, Record<string, string>> = {\r\n    n: { top: '0', left: '10px', right: '10px', height: '5px' },\r\n    e: { top: '10px', right: '0', bottom: '10px', width: '5px' },\r\n    s: { bottom: '0', left: '10px', right: '10px', height: '5px' },\r\n    w: { top: '10px', left: '0', bottom: '10px', width: '5px' },\r\n    ne: { top: '0', right: '0', width: '10px', height: '10px' },\r\n    se: { bottom: '0', right: '0', width: '10px', height: '10px' },\r\n    sw: { bottom: '0', left: '0', width: '10px', height: '10px' },\r\n    nw: { top: '0', left: '0', width: '10px', height: '10px' },\r\n  };\r\n  return positions[direction] || {};\r\n}\r\n\r\n/**\r\n * 注册窗口快捷键\r\n */\r\nfunction registerWindowShortcuts(window: JQuery): void {\r\n  $(document).on('keydown', e => {\r\n    // Esc: 关闭窗口\r\n    if (e.key === 'Escape' && window.is(':visible')) {\r\n      window.hide();\r\n    }\r\n  });\r\n}\r\n\r\n// 添加旋转动画\r\nconst style = document.createElement('style');\r\nstyle.textContent = `\r\n  @keyframes spin {\r\n    to { transform: rotate(360deg); }\r\n  }\r\n`;\r\ndocument.head.appendChild(style);\r\n\r\n// 自动初始化\r\ninit();\r\n\r\n// 默认导出\r\nexport default { init };\r\n\r\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","VTT_MAP_URL","init","document","readyState","addEventListener","loadVTTMap","$","toastr","success","length","button","attr","css","position","bottom","right","zIndex","display","alignItems","gap","padding","background","color","border","borderRadius","boxShadow","fontSize","fontWeight","cursor","transition","html","on","toggleFloatingWindow","this","transform","append","createFloatingButton","e","ctrlKey","preventDefault","window","remove","info","console","error","existingWindow","is","hide","show","top","left","width","height","maxWidth","minWidth","minHeight","flexDirection","overflow","titleBar","justifyContent","userSelect","title","controls","minimizeBtn","createControlButton","content","find","fullscreenBtn","closeBtn","createTitleBar","addClass","flex","loading","iframe","fadeOut","createContent","isDragging","startX","startY","target","closest","offset","pageX","pageY","x","y","maxX","outerWidth","maxY","outerHeight","Math","max","min","enableDragging","forEach","dir","handle","getHandlePosition","isResizing","currentDirection","startWidth","startHeight","startLeft","startTop","each","includes","replace","deltaX","deltaY","newWidth","newHeight","newLeft","newTop","enableResizing","registerWindowShortcuts","fadeIn","createFloatingWindow","text","bgColor","hoverColor","onClick","direction","n","s","w","ne","se","sw","nw","style","createElement","textContent","head","appendChild"],"sourceRoot":""}